{"version":3,"file":"review-service.js","sources":["inputJS/review-service.js"],"sourcesContent":["// import envConfiguration from './Config/config';\r\n// envConfiguration();\r\n\r\n/**\r\n *Function to normalize the payload receive in the review request call and the creation of the analyze text.\r\n *\r\n * @param {*} reviewResult\r\n */\r\nfunction renderAnalyzeReview(reviewResult) {\r\n  const divUpperFeedback = document.getElementById('upper-part-feedback');\r\n\r\n  // To clean the div;\r\n  const range = document.createRange();\r\n  range.selectNodeContents(divUpperFeedback);\r\n  range.deleteContents();\r\n\r\n  let aspectSerializer = [];\r\n\r\n  // I don't think this cart is beautiful\r\n  reviewResult.sentiment_analysis.sentence_list.forEach(sentence_list => {\r\n    // console.log('sentence_list :', sentence_list);\r\n\r\n    sentence_list.segment_list.forEach(segment_list => {\r\n      // console.log('segment_list :', segment_list);\r\n\r\n      segment_list.polarity_term_list.forEach(polarity_term_list => {\r\n        // console.log('polarity_term_list :', polarity_term_list);\r\n        let typeOfAspect = 'NEU';\r\n\r\n        if (\r\n          polarity_term_list.score_tag === 'P' ||\r\n          polarity_term_list.score_tag === 'P+'\r\n        ) {\r\n          typeOfAspect = 'positive';\r\n        } else if (\r\n          polarity_term_list.score_tag === 'N' ||\r\n          polarity_term_list.score_tag === 'N+'\r\n        ) {\r\n          typeOfAspect = 'negative';\r\n        }\r\n\r\n        aspectSerializer.push({\r\n          term: reviewResult.text.slice(\r\n            parseInt(polarity_term_list.inip),\r\n            parseInt(polarity_term_list.endp) + 1,\r\n          ),\r\n          typeOfAspect,\r\n        });\r\n\r\n        if (polarity_term_list.sentimented_concept_list) {\r\n          polarity_term_list.sentimented_concept_list.forEach(\r\n            sentimented_concept_list => {\r\n              aspectSerializer.push({\r\n                term: sentimented_concept_list.variant,\r\n                typeOfAspect: 'aspect',\r\n              });\r\n            },\r\n          );\r\n        }\r\n      });\r\n\r\n      if (segment_list.sentimented_concept_list) {\r\n        segment_list.sentimented_concept_list.forEach(\r\n          sentimented_concept_list => {\r\n            aspectSerializer.push({\r\n              term: sentimented_concept_list.variant,\r\n              typeOfAspect: 'aspect',\r\n            });\r\n          },\r\n        );\r\n      }\r\n\r\n      if (segment_list.sentimented_entity_list) {\r\n        segment_list.sentimented_entity_list.forEach(\r\n          sentimented_entity_list => {\r\n            aspectSerializer.push({\r\n              term: sentimented_entity_list.form,\r\n              typeOfAspect: 'aspect',\r\n            });\r\n          },\r\n        );\r\n      }\r\n    });\r\n  });\r\n\r\n  console.log('aspectSerializer', aspectSerializer);\r\n\r\n  reviewResult.text.split(' ').forEach(element => {\r\n    const newP = document.createElement('p');\r\n    const text = document.createTextNode(element);\r\n    newP.appendChild(text);\r\n\r\n    aspectSerializer.forEach(serializeAspect => {\r\n      const serializeTerm = serializeAspect.term.toUpperCase();\r\n      const reviewTextPart = element.replace(/[.,;_?!%$#]/g, '').toUpperCase();\r\n\r\n      if (serializeTerm === reviewTextPart && serializeAspect.term !== 'NEU') {\r\n        newP.classList.add(serializeAspect.typeOfAspect);\r\n      }\r\n    });\r\n\r\n    divUpperFeedback.appendChild(newP);\r\n  });\r\n}\r\n\r\n/**\r\n * Function to listen to submissions of example reviews\r\n */\r\nfunction analyzeDataSubmitListener() {\r\n  document\r\n    .getElementById('analyze-form')\r\n    .addEventListener('submit', function(event) {\r\n      event.preventDefault();\r\n\r\n      const textArea = event.target[0];\r\n\r\n      if (textArea.value === '') {\r\n        textArea.classList.add('animated', 'shake');\r\n        setTimeout(() => {\r\n          textArea.classList.remove('animated', 'shake');\r\n        }, 1000);\r\n        return;\r\n      }\r\n\r\n      const postParams = Object.assign(\r\n        {},\r\n        {\r\n          text: textArea.value,\r\n        },\r\n      );\r\n\r\n      axios\r\n        .post(`${process.env.DOCUMENT_END_POINT}/documents`, postParams)\r\n        .then(function(response) {\r\n          renderAnalyzeReview(response.data);\r\n          document.getElementById('feedback-text').classList.remove('hidden');\r\n          document\r\n            .getElementById('feedback-text')\r\n            .classList.add('animated', 'fadeInUp');\r\n          textArea.value = '';\r\n        })\r\n        .catch(function(error) {\r\n          throw new Error(error);\r\n        });\r\n    });\r\n}\r\n\r\nanalyzeDataSubmitListener();\r\n"],"names":[],"mappings":"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"}